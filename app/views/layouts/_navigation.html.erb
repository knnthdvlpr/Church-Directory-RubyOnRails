<!-- app/views/layouts/_navigation.html.erb -->
<nav class="bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 shadow-lg sticky top-0 z-50">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-16">
      <!-- Logo and Brand -->
      <div class="flex items-center">
        <div class="flex-shrink-0">
          <%= link_to root_path, class: "flex items-center space-x-3 group" do %>
            <div class="bg-white rounded-lg p-2 shadow-lg group-hover:scale-110 transition-transform duration-200">
              <svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
              </svg>
            </div>
            <span class="text-white text-xl font-bold tracking-tight">Church Directory</span>
          <% end %>
        </div>
        
        <!-- Desktop Navigation Links -->
        <div class="hidden md:block ml-10">
          <div class="flex items-baseline space-x-1">
            <%= link_to branches_path, class: "nav-link group relative px-4 py-2 rounded-lg text-white hover:bg-white/20 transition-all duration-200 #{current_page?(branches_path) ? 'bg-white/30' : ''}" do %>
              <div class="flex items-center space-x-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                </svg>
                <span class="font-medium">Branches</span>
              </div>
            <% end %>
            
            <%= link_to departments_path, class: "nav-link group relative px-4 py-2 rounded-lg text-white hover:bg-white/20 transition-all duration-200 #{current_page?(departments_path) ? 'bg-white/30' : ''}" do %>
              <div class="flex items-center space-x-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                </svg>
                <span class="font-medium">Departments</span>
              </div>
            <% end %>
            
            <%= link_to positions_path, class: "nav-link group relative px-4 py-2 rounded-lg text-white hover:bg-white/20 transition-all duration-200 #{current_page?(positions_path) ? 'bg-white/30' : ''}" do %>
              <div class="flex items-center space-x-2">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                </svg>
                <span class="font-medium">Positions</span>
              </div>
            <% end %>
            
            <% if current_user.has_role?(:admin) %>
              <!-- Admin Dropdown -->
              <div class="relative" data-controller="dropdown">
                <button data-action="click->dropdown#toggle" class="nav-link group relative px-4 py-2 rounded-lg text-white hover:bg-white/20 transition-all duration-200 flex items-center space-x-2">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"/>
                  </svg>
                  <span class="font-medium">Admin</span>
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                  </svg>
                </button>
                
                <div data-dropdown-target="menu" class="hidden absolute left-0 mt-2 w-56 rounded-lg shadow-xl bg-white ring-1 ring-black ring-opacity-5 overflow-hidden">
                  <%= link_to admin_members_path, class: "flex items-center px-4 py-3 text-sm text-gray-700 hover:bg-indigo-50 transition" do %>
                    <svg class="w-5 h-5 mr-3 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/>
                    </svg>
                    <div>
                      <div class="font-medium">Member Management</div>
                      <div class="text-xs text-gray-500">Manage all members</div>
                    </div>
                  <% end %>
                  
                  <%= link_to admin_roles_path, class: "flex items-center px-4 py-3 text-sm text-gray-700 hover:bg-indigo-50 transition" do %>
                    <svg class="w-5 h-5 mr-3 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                    </svg>
                    <div>
                      <div class="font-medium">Role Assignment</div>
                      <div class="text-xs text-gray-500">Assign user roles</div>
                    </div>
                  <% end %>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      </div>
      
      <!-- Right side - User menu -->
      <div class="hidden md:block">
        <div class="ml-4 flex items-center space-x-4">
          <% if user_signed_in? %>
            <!-- Profile Link -->
            <%= link_to profile_path, class: "flex items-center space-x-2 px-4 py-2 rounded-lg text-white hover:bg-white/20 transition-all duration-200" do %>
              <div class="w-8 h-8 rounded-full bg-white flex items-center justify-center shadow-lg">
                <span class="text-indigo-600 font-bold text-sm"><%= current_user.first_name[0] %><%= current_user.last_name[0] %></span>
              </div>
              <div class="text-left">
                <div class="text-sm font-medium"><%= current_user.first_name %></div>
                <% if current_user.has_role?(:admin) %>
                  <div class="text-xs bg-yellow-400 text-yellow-900 px-2 rounded-full inline-block font-semibold">Admin</div>
                <% end %>
              </div>
            <% end %>
            
            <!-- Sign Out Button -->
            <%= button_to destroy_user_session_path, method: :delete, class: "flex items-center space-x-2 px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg text-white transition-all duration-200 font-medium" do %>
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
              </svg>
              <span>Sign Out</span>
            <% end %>
          <% else %>
            <%= link_to "Sign In", new_user_session_path, class: "px-4 py-2 text-white hover:bg-white/20 rounded-lg transition font-medium" %>
            <%= link_to "Sign Up", new_user_registration_path, class: "px-4 py-2 bg-white text-indigo-600 rounded-lg hover:bg-gray-100 transition font-medium shadow-lg" %>
          <% end %>
        </div>
      </div>
      
      <!-- Mobile menu button -->
      <div class="md:hidden">
        <button data-action="click->mobile-menu#toggle" class="inline-flex items-center justify-center p-2 rounded-lg text-white hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white">
          <svg class="block h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile menu -->
  <div data-mobile-menu-target="menu" class="hidden md:hidden bg-indigo-700">
    <div class="px-2 pt-2 pb-3 space-y-1">
      <%= link_to branches_path, class: "block px-3 py-2 rounded-lg text-white hover:bg-white/20 transition font-medium" do %>
        <div class="flex items-center space-x-3">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
          </svg>
          <span>Branches</span>
        </div>
      <% end %>
      
      <%= link_to departments_path, class: "block px-3 py-2 rounded-lg text-white hover:bg-white/20 transition font-medium" do %>
        <div class="flex items-center space-x-3">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
          </svg>
          <span>Departments</span>
        </div>
      <% end %>
      
      <%= link_to positions_path, class: "block px-3 py-2 rounded-lg text-white hover:bg-white/20 transition font-medium" do %>
        <div class="flex items-center space-x-3">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
          </svg>
          <span>Positions</span>
        </div>
      <% end %>
      
      <% if user_signed_in? %>
        <%= link_to profile_path, class: "block px-3 py-2 rounded-lg text-white hover:bg-white/20 transition font-medium" do %>
          <div class="flex items-center space-x-3">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
            </svg>
            <span>My Profile</span>
          </div>
        <% end %>
        
        <% if current_user.has_role?(:admin) %>
          <div class="border-t border-white/20 my-2 pt-2">
            <div class="px-3 py-2 text-xs font-semibold text-white/70 uppercase tracking-wider">Admin</div>
            
            <%= link_to admin_members_path, class: "block px-3 py-2 rounded-lg text-white hover:bg-white/20 transition font-medium" do %>
              <div class="flex items-center space-x-3">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"/>
                </svg>
                <span>Member Management</span>
              </div>
            <% end %>
            
            <%= link_to admin_roles_path, class: "block px-3 py-2 rounded-lg text-white hover:bg-white/20 transition font-medium" do %>
              <div class="flex items-center space-x-3">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                </svg>
                <span>Role Assignment</span>
              </div>
            <% end %>
          </div>
        <% end %>
        
        <div class="border-t border-white/20 mt-2 pt-2">
          <%= button_to destroy_user_session_path, method: :delete, class: "w-full text-left px-3 py-2 rounded-lg text-white hover:bg-white/20 transition font-medium" do %>
            <div class="flex items-center space-x-3">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
              </svg>
              <span>Sign Out</span>
            </div>
          <% end %>
        </div>
      <% end %>
    </div>
    
    <% if user_signed_in? %>
      <div class="pt-4 pb-3 border-t border-white/20">
        <div class="flex items-center px-5">
          <div class="w-10 h-10 rounded-full bg-white flex items-center justify-center shadow-lg">
            <span class="text-indigo-600 font-bold"><%= current_user.first_name[0] %><%= current_user.last_name[0] %></span>
          </div>
          <div class="ml-3">
            <div class="text-base font-medium text-white"><%= current_user.full_name %></div>
            <div class="text-sm text-white/70"><%= current_user.email %></div>
          </div>
          <% if current_user.has_role?(:admin) %>
            <span class="ml-auto bg-yellow-400 text-yellow-900 px-2 py-1 rounded-full text-xs font-bold">Admin</span>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</nav>